<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Diagrammatic Readings</title>

    <link rel="stylesheet" type="text/css" href="style.css">

    <!-- bootstrap -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>

	<!-- main wavesurfer.js lib -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/1.1.2/wavesurfer.min.js"></script>


	<!-- spectrogram format renderer -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/1.1.2/plugin/wavesurfer.spectrogram.min.js"></script>
	 
	 <!-- elan transcript renderer -->
	 <script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/1.1.2/plugin/wavesurfer.elan.min.js"></script>
	 
	 <!--minimap -->
	 <script src='https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/1.1.2/plugin/wavesurfer.minimap.min.js'></script>

	<!-- wavesurfer.js regions -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/1.1.2/plugin/wavesurfer.regions.min.js"></script>	
	
	<!-- timeline -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/1.1.2/plugin/wavesurfer.timeline.min.js"></script>

  </head>
  <body>


<article> 	
    <h1>Diagrammatic Readings</h1>



	<!-- Create a div where the audio waves will be shown --> 

	<div id="waveform"></div>
	<div id="wave-timeline" class="viz"></div>
	<div id="wave-spectrogram" class="viz"></div>

	<p align="center">
		<button class="btn btn-primary" onclick="wavesurfer.playPause()">
			<i class="glyphicon glyphicon-play"></i>
							Play/Pause
		</button>
		
	</p>


	<div id="annotations"></div>

	<!-- D3 viz -->

	
	
	<script>

	var wavesurfer = WaveSurfer.create({
		container: document.querySelector ('#waveform'),
		progressColor: "black",
		waveColor: 'blue',
		backgroundColor: '#fcfcfc',
		loop: true,
		scrollParent: true,
		maxCanvasWidth: 5000,
		mediaControls: true,		
		minPxPerSec: 75
	});		
	
	wavesurfer.on('ready', function () {
		var spectrogram = Object.create(WaveSurfer.Spectrogram);
		spectrogram.init({
			wavesurfer: wavesurfer,
			container: "#wave-spectrogram",
			labels: true,
			fftSamples: 512,
			loop: true
		});
	});	
	
	wavesurfer.on('ready', function () {
		wavesurfer.addRegion({
		start: 2,
		end: 5,
		color: 'hsla(100, 100%, 30%, 0.1)' 
		});
	});
	
	wavesurfer.on('ready', function () {
		var timeline = Object.create(WaveSurfer.Timeline);
		timeline.init({
			wavesurfer: wavesurfer,
			container: "#wave-timeline"
		});
	});	
	
	wavesurfer.on('ready', function () {
		var elan = Object.create(WaveSurfer.Elan);
		elan.init({
			wavesurfer: wavesurfer,
			url: '001z.xml',
			container: "#annotations",
			tiers: {
				Text: true,
				Comments: false
			}			
		});
	});
	
	wavesurfer.load('https://raw.githubusercontent.com/diagrammaticreadings/Sing-Page-Web/main/001z.mp3');
	</script>

	



</article>




  </body>
</html>
